{% include 'base.html.twig' %}
{% block head %}
    <meta charset="utf-8">
    <meta name="author" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="This is a login page template based on Bootstrap 5">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
{% endblock %}

{% include 'navbar.html.twig' %}

{% block body %}
    <head>
        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="temp_patient/css/bootstrap.css">
        <link rel="stylesheet" href="temp_patient/css/themify-icons.css">
        <link rel="stylesheet" href="temp_patient/css/flaticon.css">
        <link rel="stylesheet" href="temp_patient/vendors/fontawesome/css/all.min.css">
        <link rel="stylesheet" href="temp_patient/vendors/owl-carousel/owl.carousel.min.css">
        <link rel="stylesheet" href="temp_patient/vendors/animate-css/animate.css">
        <!-- main css -->
        <link rel="stylesheet" href="temp_patient/css/style.css">
        <link rel="stylesheet" href="temp_patient/css/responsive.css">
    </head>
      <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }

        body {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding-bottom: 100px; /* Ajoute un espacement en bas */
            background: linear-gradient(to bottom, #C5EAC4, #379944);
        }

        .container {
            height: 100%;
        }

        .card {
            background-color: #e0f7e0; /* Vert pâle */
        }

        .feature-section {
            margin-top : 1px;
        }

        body {
    display: flex;
    justify-content: center; /* Centre horizontalement */
    align-items: center; /* Centre verticalement */
    height: 100vh; /* Hauteur de la page entière */
    margin: 0;
    background: linear-gradient(to bottom, #C5EAC4, #379944);
}

.container2 {
    display: flex;
    flex-direction: column; /* Arrange les éléments verticalement */
    align-items: center; /* Centre les éléments horizontalement */
    margin-top: 200px; /* Décale le conteneur de 200px vers le bas */
}

.liste_reaction_select {
    max-width: 400px;
    margin-top: 20px; /* Ajoute un espace entre le titre et la liste déroulante */
}

    </style>
    <body>
<!--================ Feature section start =================-->      

    <body>
    <div class="container2">
        <h2 class="liste_reactions">Liste de maladies :</h2>
        <select class="form-select liste_reaction_select" aria-label="Sélectionnez une réaction médicamenteuse" id="searchOption" name="searchOption" onchange="fetchResults()">
            <option selected>Sélectionnez une maladie..</option>
            {% for maladie in maladies %}
                <option value="{{maladie.id}}">{{maladie.name}}</option>
            {% endfor %}
        </select>
    </div>
</body>

<section class="feature-section">
    <div class="container" id="results">
       
    </div>
</section>
<!--================ Feature section end =================--> 
        <!--JavaScript -->
<script>
function fetchResults() {
    var searchOption = document.getElementById('searchOption').value;

    if (searchOption !== '') {
        // Faire une requête AJAX vers Symfony
        var xhr = new XMLHttpRequest();
        xhr.open("GET", "/search?option=" + searchOption, true);

        xhr.onreadystatechange = function() {
            if (xhr.readyState === 4 && xhr.status === 200) {
                // Convertir la réponse JSON en objet JavaScript
                var data = JSON.parse(xhr.responseText);

                // Vérifie s'il y a des résultats à afficher
                if (data.length > 0) {
                    // Générer le HTML pour les résultats
                   let resultHtml = '<ul>';
                    data.forEach(article => {
                      resultHtml += `
                            <li>
                                <h3>${article.name}</h3> <!-- Titre de l'exercice -->
                                <p>${article.description}</p> <!-- Description de l'exercice -->
                            </li>
                        `;
                    });
                   resultHtml += '</ul>';
                   console.log(resultHtml)

                    // Afficher les résultats
                    document.getElementById('results').innerHTML = resultHtml;
                } else {
                    document.getElementById('results').innerHTML = 'Aucun résultat trouvé.';
                }
            }
        };

        // Envoyer la requête
        xhr.send();
    } else {
        document.getElementById("results").innerHTML = "Veuillez sélectionner une option.";
    }
}

</script>
    </body>
</html>
{% endblock %}